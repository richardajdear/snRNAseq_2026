/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_csv from `anndata` is deprecated. Import anndata.io.read_csv instead.
  warnings.warn(msg, FutureWarning)
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_text from `anndata` is deprecated. Import anndata.io.read_text instead.
  warnings.warn(msg, FutureWarning)
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_excel from `anndata` is deprecated. Import anndata.io.read_excel instead.
  warnings.warn(msg, FutureWarning)
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_mtx from `anndata` is deprecated. Import anndata.io.read_mtx instead.
  warnings.warn(msg, FutureWarning)
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_loom from `anndata` is deprecated. Import anndata.io.read_loom instead.
  warnings.warn(msg, FutureWarning)
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_hdf from `anndata` is deprecated. Import anndata.io.read_hdf instead.
  warnings.warn(msg, FutureWarning)
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_umi_tools from `anndata` is deprecated. Import anndata.io.read_umi_tools instead.
  warnings.warn(msg, FutureWarning)
Loading /home/rajd2/rds/rds-cam-psych-transc-Pb9UGUlrwWc/Cam_snRNAseq/combined/combined_postnatal_full_harmony_10k.h5ad...
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/_core/anndata.py:1756: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
Total cells: 10000
Dataset counts:
dataset
HBCC       4190
Aging      3506
U01         833
Herring     739
Wang        722
Ramos        10
Name: count, dtype: int64

--- Running get_original_metadata ---
Extracting original metadata...
Loading metadata from sources: ['HBCC' 'AGING' 'VELMESHEV' 'WANG']
Processing VELMESHEV (1582 cells)...
Error processing Velmeshev: "['cell_subclass'] not in index"
Processing WANG (722 cells)...
Processing HBCC (4190 cells)...
Processing AGING (3506 cells)...
Traceback (most recent call last):
  File "/home/rajd2/rds/hpc-work/snRNAseq_2026/scripts/check_test_alignment.py", line 23, in <module>
    meta = get_original_metadata(obs, base_dir)
  File "/home/rajd2/rds/hpc-work/snRNAseq_2026/code/metadata_utils.py", line 194, in get_original_metadata
    ad = sc.read_h5ad(path, backed='r')
  File "/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/_io/h5ad.py", line 214, in read_h5ad
    return read_h5ad_backed(filename, mode)
  File "/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/_io/h5ad.py", line 145, in read_h5ad_backed
    f = h5py.File(filename, mode)
  File "/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/h5py/_hl/files.py", line 561, in __init__
  File "/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/h5py/_hl/files.py", line 235, in make_fid
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 102, in h5py.h5f.open
  File "h5py/h5g.pyx", line 281, in h5py.h5g.GroupID.__init__
  File "h5py/h5g.pyx", line 282, in h5py.h5g.GroupID.__init__
  File "<frozen importlib._bootstrap>", line 404, in parent
KeyboardInterrupt
