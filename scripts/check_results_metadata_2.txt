/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_csv from `anndata` is deprecated. Import anndata.io.read_csv instead.
  warnings.warn(msg, FutureWarning)
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_text from `anndata` is deprecated. Import anndata.io.read_text instead.
  warnings.warn(msg, FutureWarning)
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_excel from `anndata` is deprecated. Import anndata.io.read_excel instead.
  warnings.warn(msg, FutureWarning)
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_mtx from `anndata` is deprecated. Import anndata.io.read_mtx instead.
  warnings.warn(msg, FutureWarning)
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_loom from `anndata` is deprecated. Import anndata.io.read_loom instead.
  warnings.warn(msg, FutureWarning)
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_hdf from `anndata` is deprecated. Import anndata.io.read_hdf instead.
  warnings.warn(msg, FutureWarning)
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/utils.py:429: FutureWarning: Importing read_umi_tools from `anndata` is deprecated. Import anndata.io.read_umi_tools instead.
  warnings.warn(msg, FutureWarning)
Loading /home/rajd2/rds/rds-cam-psych-transc-Pb9UGUlrwWc/Cam_snRNAseq/combined/combined_postnatal_full_harmony_10k.h5ad...
/opt/micromamba/envs/shortcake_default/lib/python3.10/site-packages/anndata/_core/anndata.py:1756: UserWarning: Observation names are not unique. To make them unique, call `.obs_names_make_unique`.
  utils.warn_names_duplicates("obs")
Total cells: 10000
Dataset counts:
dataset
HBCC       4190
Aging      3506
U01         833
Herring     739
Wang        722
Ramos        10
Name: count, dtype: int64

--- Testing VELMESHEV ---
Extracting original metadata...
Loading metadata from sources: ['VELMESHEV']
Processing VELMESHEV (1582 cells)...
  Result shape: (1582, 7)
  All expected columns present.
  cell_class: 0 missing
  cell_type: 0 missing
    Values: ['Excitatory' 'Inhibitory' 'Oligo' 'L4 IT' 'OPC' 'Astro' 'L2/3 IT' 'Sst'
 'L5 IT' 'Micro']
  region: 0 missing
  age_years: 0 missing
  sex: 0 missing
  donor_id: 0 missing

--- Testing WANG ---
Extracting original metadata...
Loading metadata from sources: ['WANG']
Processing WANG (722 cells)...
  Result shape: (722, 8)
  All expected columns present.
  cell_class: 0 missing
  cell_type: 7 missing
    Values: ['L2/3 IT' 'Sst' 'Astro' 'Pvalb' 'Lamp5' 'Excitatory' 'L6b' 'Vip'
 'Inhibitory' 'L4 IT']
  region: 0 missing
  age_years: 0 missing
  sex: 0 missing
  donor_id: 0 missing

--- Testing HBCC ---
Extracting original metadata...
Loading metadata from sources: ['HBCC']
Processing HBCC (4190 cells)...
  HBCC: Loaded 4190 exact matches, 0 stripped matches.
  HBCC processed successfully.
  Result shape: (4190, 8)
  All expected columns present.
  cell_class: 0 missing
  cell_type: 0 missing
    Values: ['Pvalb' 'Oligo' 'Astro' 'Sst' 'L2/3 IT' 'L6 CT' 'Endo' 'VLMC' 'OPC'
 'Micro']
  region: 0 missing
  age_years: 0 missing
  sex: 0 missing
  donor_id: 0 missing

--- Testing AGING ---
Extracting original metadata...
Loading metadata from sources: ['AGING']
Processing AGING (3506 cells)...
  AGING: Loaded 3506 exact matches, 0 stripped matches.
  AGING processed successfully.
  Result shape: (3506, 8)
  All expected columns present.
  cell_class: 0 missing
  cell_type: 0 missing
    Values: ['Sst' 'Oligo' 'L2/3 IT' 'Astro' 'OPC' 'Lamp5' 'Micro' 'Endo' 'L6 CT'
 'Pvalb']
  region: 0 missing
  age_years: 0 missing
  sex: 0 missing
  donor_id: 0 missing

--- Testing ALL ---
Extracting original metadata...
Loading metadata from sources: ['HBCC' 'AGING' 'VELMESHEV' 'WANG']
Processing VELMESHEV (1582 cells)...
Processing WANG (722 cells)...
Processing HBCC (4190 cells)...
  HBCC: Loaded 4190 exact matches, 0 stripped matches.
  HBCC processed successfully.
Processing AGING (3506 cells)...
  AGING: Loaded 3506 exact matches, 0 stripped matches.
  AGING processed successfully.
Final shape: (10000, 8)
Final Cell Type Counts:
cell_type
Oligo         2382
L2/3 IT       1552
Astro         1179
OPC            996
Micro          600
Sst            523
Excitatory     470
Vip            436
Pvalb          392
Inhibitory     372
Endo           217
Lamp5          190
L6 CT          188
L4 IT          166
VLMC            79
Pericyte        79
L5/6 NP         67
L6b             60
PVM             16
L5 IT           14
IT               8
Sncg             6
L5 ET            1
Name: count, dtype: int64
